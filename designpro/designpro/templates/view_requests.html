{% extends 'base.html' %}
{% block content %}
<h2>Мои заявки</h2>
<form method="get">
    <label for="status">Фильтр по статусу:</label>
    <select name="status" id="status">
        <option value="">Все</option>
        {% for choice, choice_name in status_choices %}
            <option value="{{ choice }}" {% if request.GET.status == choice %} selected {% endif %}>{{ choice_name }}</option>
        {% endfor %}
    </select>
    <button type="submit">Фильтровать</button>
</form>
<table>
    <thead>
        <tr>
            <th>Временная метка</th>
            <th>Название</th>
            <th>Описание</th>
            <th>Категория</th>
            <th>Статус</th>
            <th>Действие</th>
        </tr>
    </thead>
    <tbody>
        {% for request in requests %}
        <tr>
            <td>{{ request.created_at }}</td>
            <td>{{ request.title }}</td>
            <td>{{ request.description }}</td>
            <td>{{ request.category }}</td>
            <td>{{ request.status }}</td>
            <td>
                {% if request.status == 'Новая' %}
                <a href="{% url 'delete_request' request.pk %}">Удалить</a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}